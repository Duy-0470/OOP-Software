CREATE DATABASE CAMDO

USE CAMDO

CREATE TABLE VAITRO(
	MaVaiTro INT PRIMARY KEY,
	Ten NVARCHAR(max)
)

CREATE TABLE TAIKHOAN(
	MaTaiKhoan INT IDENTITY(1,1) PRIMARY KEY,
	TenNhanVien NVARCHAR(max),
	TenTaiKhoan NVARCHAR(100),
	MatKhau NVARCHAR(max),
	MaVaiTro INT not null
	
	FOREIGN KEY (MaVaiTro) REFERENCES VAITRO(MaVaiTro)
)

CREATE TABLE KHACHHANG(
	MaKhachHang NVARCHAR(10) PRIMARY KEY,
	TenKhachHang NVARCHAR(MAX),
	SDT NVARCHAR(20),
	CMND NVARCHAR(12)
)

CREATE TABLE HOADON(
	MaHoaDon INT IDENTITY(1,1) PRIMARY KEY,
	MaKhachHang NVARCHAR(10) NOT NULL,
	Ngay SMALLDATETIME

	FOREIGN KEY (MaKhachHang) REFERENCES KHACHHANG(MaKhachHang),
)

CREATE TABLE CT_HOADON(
	MaCT_HoaDon INT IDENTITY(1,1) NOT NULL PRIMARY KEY,
	MaHoaDon INT,
	TenVatTu NVARCHAR(MAX) NOT NULL,
	SoLuong INT,
	GiaCam INT,
	GiaChuoc INT,
	HanChot SMALLDATETIME,
	TongTien INT,
	TrangThai Nvarchar(20)

	FOREIGN KEY (MaHoaDon) REFERENCES HOADON(MaHoaDon)
)


CREATE TABLE BAOCAODOANHSO (
	MaBCDS			INT IDENTITY (1, 1),
	ThoiGian		SMALLDATETIME, -- ngay minh muon xem bao cao doanh so
	TongDoanhThu	MONEY DEFAULT 0

	CONSTRAINT BAOCAODOANHSO_PK PRIMARY KEY (MaBCDS)
)

CREATE TABLE CT_BCDS (
	MaBCDS	INT PRIMARY KEY,
	SoLuotSua	INT DEFAULT 0,
	ThanhTien	MONEY DEFAULT 0,
	TiLe		VARCHAR(MAX)

	FOREIGN KEY (MaBCDS) REFERENCES BAOCAODOANHSO(MaBCDS)
)

CREATE TABLE THUTIEN ( 
	MaThuTien INT IDENTITY(1,1) PRIMARY KEY,
	MaHoaDon INT,
	NgayThuTien SMALLDATETIME,
	SoTienThu INT

	FOREIGN KEY (MaHoaDon) REFERENCES HOADON(MaHoaDon)
)

CREATE TABLE CT_THUTIEN (
	MaCT_ThuTien INT IDENTITY(1,1) NOT NULL PRIMARY KEY,
	MaThuTien INT,
	TenVatTu NVARCHAR(MAX) NOT NULL,
	SoLuong INT,
	GiaChuoc INT,
	ThanhTien INT
	
	FOREIGN KEY (MaThuTien) REFERENCES THUTIEN(MaThuTien)
)



SET DATEFORMAT DMY

ALTER DATABASE SCOPED CONFIGURATION 
  SET VERBOSE_TRUNCATION_WARNINGS = ON;

INSERT INTO VAITRO VALUES (0, 'staff')
INSERT INTO VAITRO VALUES (1, 'admin')

INSERT INTO TAIKHOAN (TenTaiKhoan, MatKhau, MaVaiTro,TenNhanVien) VALUES ('staff', 'staff', 0,'Duong Chan Viet')
INSERT INTO TAIKHOAN (TenTaiKhoan, MatKhau, MaVaiTro, TenNhanVien) VALUES ('admin', 'admin', 1,'Nguyen Duy Hao')

INSERT INTO KHACHHANG (MaKhachHang,TenKhachHang, SDT, CMND) VALUES ('DMT','Duong Minh Thai','0703174619', '079202003767')
INSERT INTO KHACHHANG (MaKhachHang,TenKhachHang, SDT, CMND) VALUES ('CDQ','Can Duc Quang','0868331239', '079202002343')
INSERT INTO KHACHHANG (MaKhachHang,TenKhachHang, SDT, CMND) VALUES ('CVS','Chau Vinh Sinh','0916056985', '079202006979')

INSERT INTO HOADON (MaKhachHang,Ngay) VALUES ('DMT','1/12/2022')
INSERT INTO HOADON (MaKhachHang,Ngay) VALUES ('CDQ','3/12/2022')
INSERT INTO HOADON (MaKhachHang,Ngay) VALUES ('CVS','4/12/2022')

INSERT INTO CT_HOADON (MaHoaDon, TenVatTu, SoLuong, GiaCam, GiaChuoc,TongTien,TrangThai,HanChot) VALUES (1, N'Xe may', 1, '50000000','52500000','52500000','Cam','5/1/2023')
INSERT INTO CT_HOADON (MaHoaDon, TenVatTu, SoLuong, GiaCam, GiaChuoc,TongTien,TrangThai,HanChot) VALUES (2, N'Laptop', 1, '25000000','26250000','26250000','Cam','3/1/2033')
INSERT INTO CT_HOADON (MaHoaDon, TenVatTu, SoLuong, GiaCam, GiaChuoc,TongTien,TrangThai,HanChot) VALUES (2, N'Dien thoai', 1, '10000000','10500000','10500000','Cam','3/1/2023')
INSERT INTO CT_HOADON (MaHoaDon, TenVatTu, SoLuong, GiaCam, GiaChuoc,TongTien,TrangThai,HanChot) VALUES (3, N'Dong ho', 1, '5000000','5250000','5250000','Cam','28/12/2022')
INSERT INTO CT_HOADON (MaHoaDon, TenVatTu, SoLuong, GiaCam, GiaChuoc,TongTien,TrangThai,HanChot) VALUES (3, N'Day chuyen', 1, '3000000','3150000','3150000','Cam','28/12/2022')
INSERT INTO CT_HOADON (MaHoaDon, TenVatTu, SoLuong, GiaCam, GiaChuoc,TongTien,TrangThai,HanChot) VALUES (3, N'May tinh bang', 1, '20000000','21000000','21000000','Cam','28/12/2022')

